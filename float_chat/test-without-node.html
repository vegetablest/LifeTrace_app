<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeTrace Float Chat - 浏览器测试</title>
    <link rel="stylesheet" href="styles.css">
    <script src="lib/marked.min.js"></script>
    <script src="lib/lucide.js"></script>
</head>
<body>
    <div id="app">
        <!-- 标题栏 -->
        <div class="title-bar">
            <div class="title-bar-left">
                <i data-lucide="message-circle"></i>
                <span>LifeTrace Float Chat - 浏览器测试</span>
            </div>
            <div class="title-bar-right">
                <button id="theme-toggle" class="icon-button" title="切换主题">
                    <i data-lucide="sun"></i>
                </button>
                <button id="settings-btn" class="icon-button" title="设置">
                    <i data-lucide="settings"></i>
                </button>
                <button id="new-chat-btn" class="icon-button" title="新建聊天">
                    <i data-lucide="plus"></i>
                </button>
            </div>
        </div>

        <!-- 主要内容区域 -->
        <div class="main-content">
            <!-- 欢迎屏幕 -->
            <div id="welcome-screen" class="welcome-screen">
                <div class="welcome-content">
                    <div class="welcome-icon">
                        <i data-lucide="message-circle"></i>
                    </div>
                    <h1>欢迎使用 LifeTrace Float Chat</h1>
                    <p>这是浏览器测试版本，用于验证界面功能</p>
                    <div class="welcome-features">
                        <div class="feature-item">
                            <i data-lucide="zap"></i>
                            <span>智能对话</span>
                        </div>
                        <div class="feature-item">
                            <i data-lucide="moon"></i>
                            <span>主题切换</span>
                        </div>
                        <div class="feature-item">
                            <i data-lucide="save"></i>
                            <span>本地存储</span>
                        </div>
                    </div>
                    <button id="start-chat-btn" class="primary-button">
                        <i data-lucide="message-square"></i>
                        开始聊天
                    </button>
                </div>
            </div>

            <!-- 聊天界面 -->
            <div id="chat-screen" class="chat-screen" style="display: none;">
                <div id="chat-container" class="chat-container">
                    <!-- 消息将在这里显示 -->
                </div>

                <!-- 输入区域 -->
                <div class="input-area">
                    <form id="chat-form" class="chat-form">
                        <div class="input-wrapper">
                            <textarea
                                id="message-input"
                                placeholder="输入消息... (Enter 发送，Shift+Enter 换行)"
                                rows="1"
                                maxlength="2000"
                            ></textarea>
                            <button type="submit" id="send-btn" class="send-button" title="发送消息">
                                <i data-lucide="send"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- 设置模态框 -->
        <div id="settings-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>设置</h2>
                    <button id="close-settings" class="icon-button">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="setting-group">
                        <label for="api-url">API 地址:</label>
                        <input type="url" id="api-url" value="http://localhost:8000" placeholder="http://localhost:8000">
                    </div>
                    <div class="setting-group">
                        <label for="temperature">温度 (0.0-2.0):</label>
                        <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7">
                        <span id="temperature-value">0.7</span>
                    </div>
                    <div class="setting-group">
                        <label for="max-tokens">最大 Token:</label>
                        <input type="number" id="max-tokens" min="100" max="4000" value="2000">
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="save-settings" class="primary-button">保存设置</button>
                    <button id="reset-settings" class="secondary-button">重置默认</button>
                </div>
            </div>
        </div>

        <!-- 通知容器 -->
        <div id="notification-container" class="notification-container"></div>
    </div>

    <script>
        // 模拟 Electron API
        window.electronAPI = {
            getVersion: () => Promise.resolve('1.0.0-test'),
            onNewChat: (callback) => {
                // 模拟新建聊天事件
                window.addEventListener('keydown', (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                        e.preventDefault();
                        callback();
                    }
                });
            },
            store: {
                get: (key, defaultValue) => {
                    const value = localStorage.getItem(`electron-store-${key}`);
                    return value ? JSON.parse(value) : defaultValue;
                },
                set: (key, value) => {
                    localStorage.setItem(`electron-store-${key}`, JSON.stringify(value));
                }
            }
        };

        // 添加测试提示
        document.addEventListener('DOMContentLoaded', () => {
            const testNotice = document.createElement('div');
            testNotice.style.cssText = `
                position: fixed;
                top: 10px;
                right: 10px;
                background: #fef3c7;
                color: #92400e;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 12px;
                z-index: 10000;
                border: 1px solid #fbbf24;
            `;
            testNotice.textContent = '浏览器测试模式 - 网络请求可能失败';
            document.body.appendChild(testNotice);

            // 5秒后自动隐藏
            setTimeout(() => {
                testNotice.style.opacity = '0';
                testNotice.style.transition = 'opacity 0.3s';
                setTimeout(() => testNotice.remove(), 300);
            }, 5000);
        });
    </script>
    <script src="script.js"></script>
</body>
</html>
